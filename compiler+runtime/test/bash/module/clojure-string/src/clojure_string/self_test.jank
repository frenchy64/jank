(ns clojure-string.self-test
  (:require [clojure.string :as str]))

;;TODO delete this namespace and use clojure-test-suite
;;https://github.com/jank-lang/jank/issues/226
(def char-a \a)
(def char-c \c)

(defn -main []
  (try
    ;; clojure.string/blank?
    (assert (str/blank? ""))
    (assert (str/blank? nil))
    (assert (str/blank? "  "))
    (assert (str/blank? " \t "))
    (assert (not (str/blank? "nil")))
    (assert (not (str/blank? " as df ")))
    ;; clojure.string/capitalize
    (assert (= "" (str/capitalize "")))
    (assert (= "A" (str/capitalize "a")))
    (assert (= "A thing" (str/capitalize "a Thing")))
    ;; clojure.string/escape
    (assert (= "" (str/escape "" {})))
    (assert (= "" (str/escape "" {char-a "A_A"})))
    (assert (= "" (str/escape "" {char-c "C_C"})))
    (assert (= "" (str/escape "" {char-a "A_A" char-c "C_C"})))
    (assert (= "A_AbC_C" (str/escape "abc" {char-a "A_A" char-c "C_C"})))
    ;; clojure.string/lower-case
    (assert (= "" (str/lower-case "")))
    (assert (= "asdf" (str/lower-case "ASDF")))
    (assert (= "asdf" (str/lower-case "asdf")))
    (assert (string? (str/lower-case "asdf")))
    (let [s "ASDF"]
      (assert (= "asdf" (str/lower-case "ASDF")))
      (assert (= "ASDF" s) "original string mutated"))
    ;; clojure.string/reverse
    (assert (= "" (str/reverse "")))
    (assert (= "tset-a" (str/reverse "a-test")))
    ;; clojure.string/starts-with?
    (assert (str/starts-with? "" ""))
    (assert (str/starts-with? "a-test" "a"))
    (assert (not (str/starts-with? "a-test" "b")))
    ;; clojure.string/ends-with?
    (assert (str/ends-with? "" ""))
    (assert (str/ends-with? "a-test" "t"))
    (assert (not (str/ends-with? "a-test" "s")))
    ;; clojure.string/upper-case
    (assert (= "" (str/upper-case "")))
    (assert (= "ASDF" (str/upper-case "asdf")))
    (assert (= "ASDF" (str/upper-case "ASDF")))
    (assert (string? (str/upper-case "ASDF")))
    (let [s "asdf"]
      (assert (= "ASDF" (str/upper-case "asdf")))
      (assert (= "asdf" s) "original string mutated"))))
